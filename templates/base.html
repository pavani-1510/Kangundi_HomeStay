    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}Flask Auth App{% endblock %}</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    </head>
    <body>
        <nav class="navbar">
            <div class="nav-container">
                <a href="{{ url_for('home') }}" class="logo">
                    <img src="{{ url_for('static', filename='images/logo.jpg') }}" alt="Kangundi Logo" class="logo-img">
                    <span>Kangundi HomeStay</span>
                </a>
                <div class="nav-links">
                    <a href="{{ url_for('home') }}">Home</a>
                    <a href="{{ url_for('about') }}">About</a>
                    {% if session.get('user_id') %}
                        <a href="{{ url_for('rooms') }}">Rooms</a>
                        <a href="{{ url_for('bookings') }}">Bookings</a>
                        <a href="{{ url_for('logout') }}">Logout</a>
                    {% else %}
                        <a href="{{ url_for('login') }}">Login</a>
                        <a href="{{ url_for('signup') }}">Sign Up</a>
                    {% endif %}
                </div>
            </div>
        </nav>

        <div class="container">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">
                            {{ message }}
                            <span class="close-btn" onclick="this.parentElement.style.display='none';">&times;</span>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            {% block content %}{% endblock %}
        </div>

        <footer class="main-footer">
            <p>&copy; 2026 Kangundi HomeStay. All rights reserved. <a href="{{ url_for('contact') }}">Contact</a> Â· <a href="{{ url_for('terms') }}">Terms</a></p>
        </footer>

        <script src="{{ url_for('static', filename='animations.js') }}"></script>

        {# Cashfree Drop SDK - Load before using #}
        <script src="https://sdk.cashfree.com/js/v3/cashfree.js"></script>
        <script>
        // Initialize Cashfree SDK
        let cashfree;
        const loadCashfree = async () => {
            try {
                cashfree = await Cashfree({
                    mode: "sandbox" // Change to "production" when going live
                });
                console.log('Cashfree SDK initialized successfully');
            } catch (error) {
                console.error('Cashfree SDK initialization failed:', error);
            }
        };
        loadCashfree();

        // Start a Cashfree payment. Pass an object with order_id, amount, customer_id, phone.
        async function startCashfreePayment(orderPayload) {
            try {
                if (!cashfree) {
                    console.error('Cashfree SDK not ready');
                    alert('Payment system is loading. Please wait a moment and try again.');
                    return;
                }
                
                console.log('Creating Cashfree order with payload:', orderPayload);
                const res = await fetch('/payments/create-order', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(orderPayload)
                });
                console.log('Response status:', res.status);
                const data = await res.json();
                console.log('Response data:', data);
                
                if (!data.payment_session_id) {
                    console.error('No payment_session_id in response:', data);
                    alert('Could not start payment: ' + (data.error || 'Unknown error'));
                    return;
                }
                
                console.log('Initializing Cashfree checkout with session ID:', data.payment_session_id);
                
                let checkoutOptions = {
                    paymentSessionId: data.payment_session_id,
                    redirectTarget: "_self"
                };
                
                cashfree.checkout(checkoutOptions).then(function(result) {
                    if (result.error) {
                        console.error('Checkout error:', result.error);
                        alert('Payment failed: ' + result.error.message);
                    }
                    if (result.redirect) {
                        console.log('Redirecting to payment page');
                    }
                });
            } catch (err) {
                console.error('Cashfree payment error:', err);
                alert('Payment could not be initiated: ' + err.message);
            }
        }
        </script>

        {% block extra_scripts %}{% endblock %}
    </body>
    </html>

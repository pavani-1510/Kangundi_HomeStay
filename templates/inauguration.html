{% extends "base.html" %}

{% block title %}Inauguration - Kangundi HomeStay{% endblock %}

{% block content %}
<!-- Premium Inauguration Hero Section -->
<canvas id="goldSnowCanvas" class="gold-snow-canvas"></canvas>
<div class="inauguration-hero">
    <div class="hero-background">
        <img src="{{ url_for('static', filename='images/kangundi_3.jpeg') }}" alt="Kangundi HomeStay Estate" class="hero-image dark-blur-bg">
        <div class="overlay"></div>
        <!-- Audio elements for sound effects -->
        <audio id="goldSparkleSound" src="{{ url_for('static', filename='sounds/gold_sparkle.mp3') }}" preload="auto" loop></audio>
        <audio id="ribbonCutSound" src="{{ url_for('static', filename='sounds/ribbon_cut.mp3') }}" preload="auto"></audio>
    </div>
    <div class="hero-content">
        <div class="ceremony-divider"></div>
        <div class="inauguration-section">
            <p class="inaug-designation">INAUGURATION CEREMONY</p>
            <p class="inaug-by">To be inaugurated by the Hon'ble Chief Minister of Andhra Pradesh</p>
            <p class="inaug-authority">Nara Chandra Babu Naidu &mdash; 30/01/2026</p>
        </div>
        <div class="ceremony-divider"></div>
        <h1 class="estate-name">Kangundi HomeStay</h1>
        <p class="estate-descriptor">A Heritage Estate of Historical Significance</p>
        <p class="estate-descriptor" style="font-size:1.05rem; color:#fffbe6; margin-top:0.5rem; font-style:normal;">We warmly await your presence for this momentous occasion.</p>
        <div class="ceremony-divider small"></div>
        <button type="button" class="ribbon-img-container" id="ribbonBtn" aria-label="Start Ceremony">
            <img src="{{ url_for('static', filename='images/ribbon.png') }}" alt="Ceremonial Ribbon" class="ribbon-img">
        </button>
    </div>
</div>
<!-- No curtain panels for premium effect -->
<!-- Home reveal removed: will redirect to /home after animation -->

<!-- Premium Stylesheet -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Montserrat:wght@400;600&display=swap">
<link rel="stylesheet" href="{{ url_for('static', filename='premium_inauguration.css') }}">

<style>
.gold-snow-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw !important;
    height: 100vh !important;
    pointer-events: none;
    z-index: 10000;
    opacity: 0.85;
}
/* Make hero image dark and blurred */
.dark-blur-bg {
    filter: blur(10px) brightness(0.35) !important;
}
/* Hide header and footer only for this page */
header, footer, nav { display: none !important; }
</style>

<script>
// --- Gold Snowfall Effect (Premium) ---
function startGoldSnow() {
    const canvas = document.getElementById('goldSnowCanvas');
    if (!canvas) return;
    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);
    const ctx = canvas.getContext('2d');
    // More, larger, brighter, shimmering flakes
    const snowflakes = Array.from({length: 120}, () => ({
        x: Math.random()*canvas.width,
        y: Math.random()*canvas.height,
        r: 1.8+Math.random()*3.8,
        alpha: 0.32+Math.random()*0.38,
        speed: 0.22+Math.random()*0.32,
        drift: (Math.random()-0.5)*0.22,
        shimmer: Math.random()*Math.PI*2
    }));
    function draw() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        const now = Date.now()/700;
        snowflakes.forEach(f => {
            ctx.save();
            // Animate shimmer
            const shimmer = 0.5 + 0.5*Math.sin(now+f.shimmer);
            ctx.globalAlpha = f.alpha * (0.7 + 0.3*shimmer);
            ctx.beginPath();
            ctx.arc(f.x, f.y, f.r * (0.85 + 0.25*shimmer), 0, Math.PI*2);
            ctx.fillStyle = 'rgba(255, 220, 120, 0.98)';
            ctx.shadowColor = '#fffbe6';
            ctx.shadowBlur = 18 + 8*shimmer;
            ctx.fill();
            ctx.restore();
            f.y += f.speed;
            f.x += f.drift;
            if (f.y > canvas.height+8) { f.y = -8; f.x = Math.random()*canvas.width; }
            if (f.x < 0) f.x = canvas.width;
            if (f.x > canvas.width) f.x = 0;
        });
        requestAnimationFrame(draw);
    }
    draw();
}
window.addEventListener('DOMContentLoaded', startGoldSnow);

// --- Sound Effects ---
function playSound(id, options = {}) {
    const el = document.getElementById(id);
    if (el) {
        if (options.reset) el.currentTime = 0;
        el.play();
    }
}
// Ensure gold sparkle sound loops and starts on page load
window.addEventListener('DOMContentLoaded', function() {
    const goldSound = document.getElementById('goldSparkleSound');
    if (goldSound) {
        goldSound.loop = true;
        goldSound.currentTime = 0;
        goldSound.volume = 0.18;
        goldSound.play().catch(() => {
            // If autoplay fails, try to play on first user interaction (ribbon click)
            const ribbonBtn = document.getElementById('ribbonBtn');
            if (ribbonBtn) {
                const tryPlay = () => {
                    goldSound.play().catch(()=>{});
                    ribbonBtn.removeEventListener('click', tryPlay);
                };
                ribbonBtn.addEventListener('click', tryPlay);
            }
        });
    }
    const ribbonCutSound = document.getElementById('ribbonCutSound');
    if (ribbonCutSound) {
        ribbonCutSound.volume = 1;
    }
});

// --- Luxurious Premium Inauguration Transition ---
window.addEventListener('load', function() {
    const ribbonBtn = document.getElementById('ribbonBtn');
    const hero = document.querySelector('.inauguration-hero');
    const ribbonCutSound = document.getElementById('ribbonCutSound');
    let animating = false;
    if (!ribbonBtn) { console.warn('Ribbon button not found!'); return; }
    // No need to restart gold sparkle after ribbon cut; it loops continuously
    ribbonBtn.addEventListener('click', function(e) {
        playSound('ribbonCutSound');
        if (animating) return;
        animating = true;
        // Fade out hero
        if (hero) {
            hero.style.transition = 'opacity 1.1s cubic-bezier(0.77,0,0.18,1)';
            hero.style.opacity = 0;
        }
        // Add gold fade overlay with animated shimmer, logo watermark
        let overlay = document.createElement('div');
        overlay.className = 'luxury-fade-overlay shimmer-bg';
        overlay.innerHTML = `
            <div class="luxury-logo-watermark animated">
                <img src="/static/images/logo.jpg" alt="Kangundi Logo" />
                <div class="luxury-logo-text">Kangundi HomeStay</div>
            </div>
        `;
        document.body.appendChild(overlay);
        setTimeout(() => {
            overlay.style.opacity = 1;
            // Trigger confetti when logo is displayed
            if (typeof confettiBlast === 'function') confettiBlast();
            setTimeout(() => {
                // Stop gold_sparkle sound before redirect
                const goldSound = document.getElementById('goldSparkleSound');
                if (goldSound) {
                    goldSound.pause();
                    goldSound.currentTime = 0;
                }
                window.location.href = '/home';
            }, 4500);
        }, 600);
    });
});
</script>
<script>
// Elegant Confetti Blast (premium style)
function confettiBlast() {
    const colors = [
        '#FFD700', '#FFF8DC', '#FFECB3', '#FFFACD', '#F5DEB3', '#E5C100', '#FFFBE6', '#F9D423', '#F6E27A'
    ];
    for (let i = 0; i < 180; i++) {
        const conf = document.createElement('div');
        conf.className = 'confetti';
        conf.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
        conf.style.left = Math.random()*100 + 'vw';
        conf.style.animationDuration = (1.8 + Math.random()*1.7) + 's';
        conf.style.opacity = 0.85 + Math.random()*0.15;
        conf.style.transform = `rotate(${Math.random()*360}deg)`;
        conf.style.width = (7+Math.random()*7)+'px';
        conf.style.height = (14+Math.random()*10)+'px';
        conf.style.position = 'fixed';
        conf.style.top = '-30px';
        conf.style.zIndex = 12000;
        document.body.appendChild(conf);
        setTimeout(()=>{ conf.remove(); }, 3200);
    }
}
</script>
{% endblock %}